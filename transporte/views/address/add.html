
<section class="ui segment" id="addAddress">
    <h1 class="ui header">Agregar direcci贸n.</h1>
    <form class="ui form" action="/direccion/add" method="POST">
      <div class="required field">
        <label>Detalle de la direcci贸n:</label>
        <input type="text" id="detail" name="detail" placeholder="Ej: # de casa o local, # de pasaje o calle, colonia o urbanizaci贸n" value="{{detail}}"> 
      </div>
      <div class ="two fields">
        <div class="required field">
          <label>Departamento:</label>
          <select class="ui dropdown" id="departamento" name="departamento">
            <option value="">--Seleccione un departamento--</option>
            {% for dep in Departamentos %}
            <option value="{{ dep.id }}">{{ dep.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="required field">
          <label>Municipio:</label> 
          <select class="ui dropdown" id="municipio" name="municipio">
              <option value=""></option>
          </select>
        </div>
      </div> 
      <button class="ui positive button" type="submit">Agregar direcci贸n</button>
    </form>
    {% if errors %}
      <div class="ui error message">
        {% for error in errors %}
          <li> {{ error.msg }} </li>
        {% endfor %}
      </div>
      {% endif %}
  </section>

  <script type="text/javascript">
    $('#departamento').change(function () {
        var selectedDepartamento = $("#departamento").val();
        var municipiosSelect = $('#municipio');
        municipiosSelect.empty();
        if (selectedDepartamento != null && selectedDepartamento != '') {
            $.getJSON('http://localhost:3000/direccion/getMunicipios',{selectedDepartamento}, function (municipios) {
                if (municipios != null && !jQuery.isEmptyObject(municipios))
                {
                    municipiosSelect.append($('<option/>', {
                        value: null,
                        text: "--Seleccione un municipio--"
                    }));
                    $.each(municipios, function (index, municipio) {
                        municipiosSelect.append($('<option/>', {
                            value: municipio.id,
                            text: municipio.name
                        }));
                    });
                };
            });
        };
    });
</script>